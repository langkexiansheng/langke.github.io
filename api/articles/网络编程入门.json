{"title":"网络编程入门","slug":"网络编程入门","date":"2018-12-13T08:01:42.000Z","updated":"2018-12-13T08:16:44.950Z","comments":true,"path":"api/articles/网络编程入门.json","photos":[],"link":"","excerpt":"客户端","covers":["https://bj.bcebos.com/v1/image-langke/hexo-neirongpeitu/python/socket_yanshi.png"],"content":"<h1 id=\"客户端\"><a href=\"#客户端\" class=\"headerlink\" title=\"客户端\"></a>客户端</h1><a id=\"more\"></a>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># -*- coding: utf-8 -*-</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> socket</span><br><span class=\"line\"></span><br><span class=\"line\">target_host = <span class=\"string\">\"127.0.0.1\"</span></span><br><span class=\"line\">target_port = <span class=\"number\">99</span></span><br><span class=\"line\"></span><br><span class=\"line\">client = socket.socket(socket.AF_INET,socket.SOCK_STREAM)</span><br><span class=\"line\">client.connect((target_host,target_port))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">while</span> <span class=\"keyword\">True</span>:</span><br><span class=\"line\">    datas = input(<span class=\"string\">\"~:\"</span>)</span><br><span class=\"line\">    client.send(bytes(datas,encoding=<span class=\"string\">'utf8'</span>))</span><br><span class=\"line\">    data = client.recv(<span class=\"number\">4096</span>)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> str(data,encoding=<span class=\"string\">'utf-8'</span>):</span><br><span class=\"line\">        print(str(data,encoding=<span class=\"string\">'utf-8'</span>))</span><br></pre></td></tr></table></figure>\n<h1 id=\"服务端\"><a href=\"#服务端\" class=\"headerlink\" title=\"服务端\"></a>服务端</h1><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># -*- coding: utf-8 -*- </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> socket</span><br><span class=\"line\"><span class=\"keyword\">import</span> threading</span><br><span class=\"line\"></span><br><span class=\"line\">bind_ip   = <span class=\"string\">'127.0.0.1'</span></span><br><span class=\"line\">bind_port = <span class=\"number\">99</span></span><br><span class=\"line\"></span><br><span class=\"line\">server = socket.socket(socket.AF_INET,socket.SOCK_STREAM)</span><br><span class=\"line\">server.bind((bind_ip,bind_port))</span><br><span class=\"line\">server.listen(<span class=\"number\">5</span>)</span><br><span class=\"line\">print(<span class=\"string\">'[*] Listening on %s:%d'</span> % (bind_ip,bind_port))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">handle_client</span><span class=\"params\">(client_socket)</span>:</span></span><br><span class=\"line\">    <span class=\"keyword\">while</span> <span class=\"keyword\">True</span>:</span><br><span class=\"line\">        request = client_socket.recv(<span class=\"number\">1024</span>)</span><br><span class=\"line\">        print(<span class=\"string\">\"[*] Received: %s\"</span> % str(request,encoding=<span class=\"string\">'utf-8'</span>))</span><br><span class=\"line\">        client_socket.send(bytes(<span class=\"string\">\"已成功接收\"</span>,encoding=<span class=\"string\">'utf8'</span>))</span><br><span class=\"line\">        </span><br><span class=\"line\"><span class=\"keyword\">while</span> <span class=\"keyword\">True</span>:</span><br><span class=\"line\">    client,addr = server.accept()</span><br><span class=\"line\">    print(<span class=\"string\">\"[*] Accepted connection from:%s:%d\"</span> % (addr[<span class=\"number\">0</span>],addr[<span class=\"number\">1</span>]))</span><br><span class=\"line\">    client_handler = threading.Thread(target=handle_client,args=(client,))</span><br><span class=\"line\">    client_handler.start()</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>演示：<br><img src=\"https://bj.bcebos.com/v1/image-langke/hexo-neirongpeitu/python/socket_yanshi.png\" alt=\"\"></p>\n</blockquote>\n<p>暂时只能发送文字，最简单的服务端和客户端。</p>\n","categories":[],"tags":[{"name":"python-网络","slug":"python-网络","count":1,"path":"api/tags/python-网络.json"}]}